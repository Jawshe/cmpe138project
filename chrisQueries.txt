//  Christopher Park 015073136
//
//  Query one, uses COUNT to list the total number of reports per product name in descending order. Used to see which item has the most reports.
//
//  This showed EXEMPTION 4 had 64133 reports while a Johnson and Johnson baby powder found to have caused cancer came in second
//  with 1741 reports. At this point, I realized I wanted to change the scope of my query.

SELECT 
  COUNT(DISTINCT report_number) AS TotalReports, products_brand_name #Selects number of individual report numbers and product names
FROM 
  bigquery-public-data.fda_food.food_events                          #Only displays outputs with industry product code for cometics
GROUP BY
  products_brand_name                                                #Groups results by products
ORDER BY
  TotalReports DESC                                                  #Orders results by number of results (descending)
LIMIT 20



//  Query two, selects the year and month for each report for a given item and extracts the month and year.
//  Then, a count is started for each month+year combination that counts the number of reports per month

SELECT
  EXTRACT(YEAR FROM date_started) AS Year,                           #Select the year from date_started (When food related event began, not report date)
  EXTRACT(MONTH FROM date_started) AS Month,                         #Same as above but for month 
  COUNT(*) AS num_reports                                            #Counts number of reports for each month and year combo
FROM
  bigquery-public-data.fda_food.food_events
WHERE
  products_brand_name = 'JOHNSONS POWDER NO UPC'                     #Limits search to one product, can be changed to change product being searched
GROUP BY
  Year, Month
ORDER BY
  Year, Month;